This is a part of a project submitted to World Virtual GovHack 2017.

## Background

For planning, marketing, and many other activities, it is important to analyze, visualize, and compare time variations (trends) of various items (including regions).

Most methods for comparing items use point-by-point correlation. These approaches work poorly in some situations, and may even be deceiving.

Our alternative method is based on the correlation of statistics of time variations.  

## Work

Fuel vendors in USA are required to file monthly detailed sales reports to state tax departments. The state departments are required to file monthly summary reports to the federal transportation department.

We downloaded reports from the federal transportation department, extracted data, and compiled all the data in Excel spreadsheets and also in CSV formats.

We developed a Visual Basic macro tool, which enables: computation of linear, quadratic, and other types of variations in fuel sales for each state; computation of correlations of variations and their comparisons; creation of vector maps; and interactive visualization of data on a map.

## Macro

The Show Trend button on the macro file produces a color map of USA and changes the colors of the states depending on their monthly fuel sales.

The vector map technique presented here can be used in many situations without any subscription based services.

The Show Friends button on the macro file computes and compares statistics of the sales data.

States having higher correlation are construed as “friends”.

If a state is clicked on the vector map, the map shows its linked “friendly” state.

## Files

TrendFriendsMacro.xlsm is the Excel macro file developed for this projcet.

a0Common.bas and other *.bas files are VBA modules from this macro file.

TrendFriends.mp4 is a short video uploaded to https://vimeo.com/249220843.

TrendFriends.pptx contains the above text content.

Gasoline.csv and SpecFuel.csv files have data taken from https://www.fhwa.dot.gov/

TrendFriends.xlsm and TrendMap.xlsm files are files generated by the above macro file with the above csv files.

TrendFriendsLogo.png is the logo of this project team.